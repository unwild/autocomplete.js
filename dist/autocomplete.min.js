/*
 * @license MIT
 *
 * Autocomplete.js v2.7.1
 * Developed by Baptiste Donaux
 * http://autocomplete-js.com
 *
 * (c) 2017, Baptiste Donaux
 */
var ConditionOperator,EventType,AutoComplete;(function(n){n[n.AND=0]="AND";n[n.OR=1]="OR"})(ConditionOperator||(ConditionOperator={})),function(n){n[n.KEYDOWN=0]="KEYDOWN";n[n.KEYUP=1]="KEYUP"}(EventType||(EventType={}));AutoComplete=function(){function n(t,i){var u,r;if(t===void 0&&(t={}),i===void 0&&(i="[data-autocomplete]"),Array.isArray(i))i.forEach(function(i){new n(t,i)});else if(typeof i=="string")u=document.querySelectorAll(i),Array.prototype.forEach.call(u,function(i){new n(t,i)});else return r=n.merge(n.defaults,t,{DOMResults:document.createElement("div")}),n.prototype.create(r,i),r}return n.prototype.create=function(t,i){if(t.Input=i,t.Input.nodeName.match(/^INPUT$/i)&&(t.Input.hasAttribute("type")===!1||t.Input.getAttribute("type").match(/^TEXT|SEARCH$/i))){t.Input.setAttribute("autocomplete","off");t._Position(t);t.Input.parentNode.appendChild(t.DOMResults);t.$Listeners={blur:t._Blur.bind(t),destroy:n.prototype.destroy.bind(null,t),focus:t._Focus.bind(t),keyup:n.prototype.event.bind(null,t,EventType.KEYUP),keydown:n.prototype.event.bind(null,t,EventType.KEYDOWN),position:t._Position.bind(t)};for(var r in t.$Listeners)t.Input.addEventListener(r,t.$Listeners[r])}},n.prototype.getEventsByType=function(n,t){var u={},i,r;for(i in n.KeyboardMappings)r=EventType.KEYUP,n.KeyboardMappings[i].Event!==undefined&&(r=n.KeyboardMappings[i].Event),r==t&&(u[i]=n.KeyboardMappings[i]);return u},n.prototype.event=function(t,i,r){var o=function(t){(u===!0&&f.Operator==ConditionOperator.AND||u===!1&&f.Operator==ConditionOperator.OR)&&(t=n.merge({Not:!1},t),t.hasOwnProperty("Is")?u=t.Is==r.keyCode?!t.Not:t.Not:t.hasOwnProperty("From")&&t.hasOwnProperty("To")&&(u=r.keyCode>=t.From&&r.keyCode<=t.To?!t.Not:t.Not))},e,f,u;for(e in n.prototype.getEventsByType(t,i))f=n.merge({Operator:ConditionOperator.AND},t.KeyboardMappings[e]),u=ConditionOperator.AND==f.Operator,f.Conditions.forEach(o),u===!0&&f.Callback.call(t,r)},n.prototype.makeRequest=function(n,t,i){var f=Object.getOwnPropertyNames(n.HttpHeaders),r=new XMLHttpRequest,o=n._HttpMethod(),e=n._Url(),s=n._Pre(),h=encodeURIComponent(n._QueryArg())+"="+encodeURIComponent(s),u;for(o.match(/^GET$/i)&&(e+=e.indexOf("?")!==-1?"&"+h:"?"+h),r.open(o,e,!0),u=f.length-1;u>=0;u--)r.setRequestHeader(f[u],n.HttpHeaders[f[u]]);return r.onreadystatechange=function(){r.readyState==4&&r.status==200?(n.$Cache["["+n.Input.id+"]"+s]=r.response,t(r.response)):r.status>=400&&i()},r},n.prototype.ajax=function(t,i,r){r===void 0&&(r=!0);t.$AjaxTimer&&window.clearTimeout(t.$AjaxTimer);r===!0?t.$AjaxTimer=window.setTimeout(n.prototype.ajax.bind(null,t,i,!1),t.Delay):(t.Request&&t.Request.abort(),t.Request=i,t.Request.send(t._QueryArg()+"="+t._Pre()))},n.prototype.cache=function(t,i,r){var u=t._Cache(t.Input.id,t._Pre()),f;u===undefined?(f=n.prototype.makeRequest(t,i,r),n.prototype.ajax(t,f)):i(u)},n.prototype.destroy=function(n){for(var t in n.$Listeners)n.Input.removeEventListener(t,n.$Listeners[t]);n.DOMResults.parentNode.removeChild(n.DOMResults)},n.merge=function(){for(var i={},t,n=0;n<arguments.length;n++)for(t in arguments[n])i[t]=arguments[n][t];return i},n.defaults={Delay:150,EmptyMessage:"No result here",Highlight:{getRegex:function(n){return new RegExp(n,"ig")},transform:function(n){return"<strong>"+n+"<\/strong>"}},HttpHeaders:{"Content-type":"application/x-www-form-urlencoded"},Limit:0,MinChars:0,HttpMethod:"GET",QueryArg:"q",Url:null,KeyboardMappings:{Enter:{Conditions:[{Is:13,Not:!1}],Callback:function(n){if(this.DOMResults.getAttribute("class").indexOf("open")!=-1){var t=this.DOMResults.querySelector("li.active");t!==null&&(n.preventDefault(),this._Select(t),this.DOMResults.setAttribute("class","autocomplete"))}},Operator:ConditionOperator.AND,Event:EventType.KEYDOWN},KeyUpAndDown_down:{Conditions:[{Is:38,Not:!1},{Is:40,Not:!1}],Callback:function(n){n.preventDefault()},Operator:ConditionOperator.OR,Event:EventType.KEYDOWN},KeyUpAndDown_up:{Conditions:[{Is:38,Not:!1},{Is:40,Not:!1}],Callback:function(n){n.preventDefault();var r=this.DOMResults.querySelector("li:first-child:not(.locked)"),u=this.DOMResults.querySelector("li:last-child:not(.locked)"),t=this.DOMResults.querySelector("li.active");if(t){var e=Array.prototype.indexOf.call(t.parentNode.children,t),i=e+(n.keyCode-39),f=this.DOMResults.getElementsByTagName("li").length;i<0?i=f-1:i>=f&&(i=0);t.classList.remove("active");t.parentElement.children.item(i).classList.add("active")}else u&&n.keyCode==38?u.classList.add("active"):r&&r.classList.add("active")},Operator:ConditionOperator.OR,Event:EventType.KEYUP},AlphaNum:{Conditions:[{Is:13,Not:!0},{From:35,To:40,Not:!0}],Callback:function(){var i=this.Input.getAttribute("data-autocomplete-old-value"),t=this._Pre();t!==""&&t.length>=this._MinChars()?(i&&t==i||this.DOMResults.setAttribute("class","autocomplete open"),n.prototype.cache(this,function(n){this._Render(this._Post(n));this._Open()}.bind(this),this._Error)):this._Close()},Operator:ConditionOperator.AND,Event:EventType.KEYUP}},DOMResults:null,Request:null,Input:null,_EmptyMessage:function(){return this.Input.hasAttribute("data-autocomplete-empty-message")?this.Input.getAttribute("data-autocomplete-empty-message"):this.EmptyMessage!==!1?this.EmptyMessage:""},_Limit:function(){var n=this.Input.getAttribute("data-autocomplete-limit");return isNaN(n)||n===null?this.Limit:parseInt(n,10)},_MinChars:function(){var n=this.Input.getAttribute("data-autocomplete-minchars");return isNaN(n)||n===null?this.MinChars:parseInt(n,10)},_Highlight:function(n){return n.replace(this.Highlight.getRegex(this._Pre()),this.Highlight.transform)},_HttpMethod:function(){return this.Input.hasAttribute("data-autocomplete-method")?this.Input.getAttribute("data-autocomplete-method"):this.HttpMethod},_QueryArg:function(){return this.Input.hasAttribute("data-autocomplete-param-name")?this.Input.getAttribute("data-autocomplete-param-name"):this.QueryArg},_Url:function(){return this.Input.hasAttribute("data-autocomplete")?this.Input.getAttribute("data-autocomplete"):this.Url},_Blur:function(n){if(n===void 0&&(n=!1),n)this._Close();else{var t=this;setTimeout(function(){t._Blur(!0)},150)}},_Cache:function(n,t){return this.$Cache["["+n+"]"+t]},_Focus:function(){var n=this.Input.getAttribute("data-autocomplete-old-value");(!n||this.Input.value!=n)&&this._MinChars()<=this.Input.value.length&&this.DOMResults.setAttribute("class","autocomplete open")},_Open:function(){var n=this;Array.prototype.forEach.call(this.DOMResults.getElementsByTagName("li"),function(t){t.getAttribute("class")!="locked"&&(t.onclick=function(){n._Select(t)},t.onmousedown=function(){n._Select(t)})})},_Close:function(){this.DOMResults.setAttribute("class","autocomplete")},_Position:function(){this.DOMResults.setAttribute("class","autocomplete");this.DOMResults.setAttribute("style","top:"+(this.Input.offsetTop+this.Input.offsetHeight)+"px;left:"+this.Input.offsetLeft+"px;width:"+this.Input.clientWidth+"px;")},_Render:function(n){var t;t=typeof n=="string"?this._RenderRaw(n):this._RenderResponseItems(n);this.DOMResults.hasChildNodes()&&this.DOMResults.removeChild(this.DOMResults.childNodes[0]);this.DOMResults.appendChild(t)},_RenderResponseItems:function(n){var u=document.createElement("ul"),i=document.createElement("li"),r=this._Limit(),t;for(r<0?n=n.reverse():r===0&&(r=n.length),t=0;t<Math.min(Math.abs(r),n.length);t++)i.innerHTML=n[t].Label,i.setAttribute("data-autocomplete-value",n[t].Value),u.appendChild(i),i=document.createElement("li");return u},_RenderRaw:function(n){var r=document.createElement("ul"),t=document.createElement("li"),i;return n.length>0?this.DOMResults.innerHTML=n:(i=this._EmptyMessage(),i!==""&&(t.innerHTML=i,t.setAttribute("class","locked"),r.appendChild(t))),r},_Post:function(n){var i,t,r,u;try{if(i=[],t=JSON.parse(n),Object.keys(t).length===0)return"";if(Array.isArray(t))for(r=0;r<Object.keys(t).length;r++)i[i.length]={Value:t[r],Label:this._Highlight(t[r])};else for(u in t)i.push({Value:u,Label:this._Highlight(t[u])});return i}catch(f){return n}},_Pre:function(){return this.Input.value},_Select:function(n){this.Input.value=n.hasAttribute("data-autocomplete-value")?n.getAttribute("data-autocomplete-value"):n.innerHTML;this.Input.setAttribute("data-autocomplete-old-value",this.Input.value)},_Error:function(){},$AjaxTimer:null,$Cache:{},$Listeners:{}},n}();
